<app-patient-nav-bar></app-patient-nav-bar>
<div class="d-flex justify-content-center text-white my-3">
    <form class="bg-dark m-auto rounded-3 shadow-lg w-80">
        <div class="d-flex justify-content-center">
            <p class="h2 mt-3 mx-auto font-weight-bold">Request Appointment</p>
        </div>
        <div class="d-flex justify-content-center">
            <div class="w-10">
                <input type="radio" class="btn-check w-100" name="prefer" id="time" value="time" [(ngModel)]="prefer">
                    <label class="btn btn-outline-success w-100" for="time">Time</label>
            </div>
            <div class="w-50">
                <div class="justify-content-evenly" (mouseleave)="validate()">
                    <div class="mb-3">
                        <div class="input-group">
                            <span class="input-group-text">Date: </span>
                            <input type="date" class="form-control" [(ngModel)]="fromDate" [ngModelOptions]="{standalone: true}" >
                            <input type="date" class="form-control" [(ngModel)]="toDate" [ngModelOptions]="{standalone: true}">
                        </div>
                    </div>
                </div>
                <div class="justify-content-evenly" (mouseleave)="validate()">
                    <div class="mb-3">
                        <div class="input-group">
                            <span class="input-group-text">Time: </span>
                            <input type="time" class="form-control" [(ngModel)]="fromTime" [ngModelOptions]="{standalone: true}">
                            <input type="time" class="form-control" [(ngModel)]="toTime" [ngModelOptions]="{standalone: true}">
                        </div>
                    </div>
                </div>
            </div>
            <div class="w-10" (mouseleave)="validate()">
                <input type="radio" class="btn-check w-100" name="prefer" id="doctor" value="doctor" [(ngModel)]="prefer" checked>
                    <label class="btn btn-outline-success w-100" for="doctor">Doctor</label>
            </div>
            <div>
                <div class="row justify-content-evenly" (mouseleave)="validate()">
                    <div class="mb-3">
                        <div class="input-group">
                            <select class="form-select" [(ngModel)]="selectedDoctorID" [ngModelOptions]="{standalone: true}">
                                <option *ngFor="let doctor of doctors;" [value]="doctor.id">{{doctor.fullName}} - {{doctor.specialization}}</option>
                            </select>
                        </div>
                    </div>
                </div>
                <button class="btn btn-success w-100" (click)="check()" [disabled]="!isValid">Check Free Appointments</button>
            </div>
        </div>

        

        <div style="height: 2px;" class="bg-light"></div>
        <div class="d-flex" (mouseenter)="validate()">
            <table class="table table-dark mb-0">
                <thead class="table-dark">
                    <tr>
                        <th class="col-1 text-center font-weight-bold h5 align-middle"></th>
                        <th class="col-3 text-center font-weight-bold h5 align-middle">Day and Time</th>
                        <th class="col-3 text-center font-weight-bold h5 align-middle">Doctor</th>
                        <th class="col-3 text-center font-weight-bold h5 align-middle">Doctor Sprecialisation</th>
                        <th class="col-1 text-center font-weight-bold h5 align-middle"></th>
                    </tr>
                </thead>
            </table>
        </div>
        <div style="height: 1px;" class="bg-light"></div>
        <div style="height: 300px; overflow-y: scroll;">
            <table class="table table-dark table-striped table-hover">
                <tbody>
                    <tr *ngFor="let availableAppointment of availableAppointments; let i = index;">
                        <th class="col-1 text-center font-weight-bold h5 align-middle">{{i + 1}})</th>
                        <th class="col-3 text-center font-weight-bold h5 align-middle">{{availableAppointment.date}} at {{availableAppointment.time}} {{availableAppointment.dayInWeek}}</th>
                        <th class="col-3 text-center font-weight-bold h5 align-middle">{{availableAppointment.doctorFullName}}</th>
                        <th class="col-3 text-center font-weight-bold h5 align-middle">{{availableAppointment.specialtization}}</th>
                        <th class="col-1 text-center font-weight-bold h5 align-middle">
                            <button class="btn btn-outline-info" 
                            (click)="createAppointment(
                                availableAppointment.date, 
                                availableAppointment.time,
                                availableAppointment.doctorID)">
                                Request Appointment
                            </button>
                        </th>
                    </tr>
                </tbody>
            </table>
        </div>
    </form>
</div>